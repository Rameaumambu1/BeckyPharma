{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Pharma - Gestion{% endblock %}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    body {
      background-color: #f8f9fa;
      padding-top: 70px;
      color: #212529;
    }
    .nav-tabs .nav-link.active {
      background-color: #0d6efd;
      color: #fff;
      font-weight: bold;
    }
    .nav-tabs .nav-link {
      color: #0d6efd;
      cursor: pointer;
    }
    .summary-box {
      background-color: #fff;
      border: 1px solid #dee2e6;
      border-radius: 0.5rem;
      padding: 20px;
      text-align: center;
      box-shadow: 0 0.25rem 0.5rem rgba(0,0,0,0.05);
    }
    .summary-box i {
      font-size: 2rem;
      margin-bottom: 10px;
      color: #0d6efd;
    }
    .summary-box h5 {
      font-size: 1.1rem;
      margin-top: 10px;
    }
    .navbar-brand img {
      height: 30px;
      margin-right: 10px;
    }

    /* Dark mode styles */
    body.dark-mode {
      background-color: #121212;
      color: #e0e0e0;
    }
    body.dark-mode .navbar {
      background-color: #1f1f1f !important;
    }
    body.dark-mode .summary-box {
      background-color: #1e1e1e;
      border-color: #333;
      box-shadow: none;
      color: #e0e0e0;
    }
    body.dark-mode .summary-box i {
      color: #ffcc00;
    }
    body.dark-mode .nav-tabs .nav-link.active {
      background-color: #bb86fc !important;
      color: #121212 !important;
      font-weight: bold;
    }
    body.dark-mode .nav-tabs .nav-link {
      color: #bb86fc !important;
      cursor: pointer;
    }
    body.dark-mode .table {
      background-color: #1e1e1e !important;
      color: #e0e0e0;
    }
    body.dark-mode .table thead {
      background-color: #2c2c2c !important;
      color: #e0e0e0;
    }
    body.dark-mode .table tbody tr {
      background-color: #1e1e1e !important;
    }
    body.dark-mode footer {
      background-color: #1f1f1f !important;
      color: #ccc !important;
    }


    /* Dark mode styles */
    body.dark-mode {
      background-color: #121212;
      color: #e0e0e0;
    }
    body.dark-mode .navbar {
      background-color: #1f1f1f !important;
    }
    body.dark-mode .modal-content {
      background-color: #000000; /* noir profond */
      color: #e0e0e0;
    }
    body.dark-mode .modal-body {
      background-color: #000000 !important; /* fond noir aussi */
    }
    body.dark-mode .form-control,
    body.dark-mode .form-label,
    body.dark-mode .input-group-text {
      background-color: #121212;
      color: #e0e0e0;
      border-color: #444;
    }
    body.dark-mode .form-control::placeholder {
      color: #bbb;
    }
    body.dark-mode .btn-close {
      filter: invert(1);
    }
    /* Toggle button styles */
    #modeToggle {
      border: 1px solid #fff;
    }
  </style>
</head>
<body>


<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand text-white" href="{% url 'dashboard' %}">
      <i class="bi bi-capsule me-1"></i>BeckyPharma
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" 
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active fw-bold text-light{% endif %}" aria-current="page" href="{% url 'dashboard' %}">
            <i class="bi bi-speedometer2"></i> Tableau de bord
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link {% if request.resolver_match.url_name == 'employes' %}active fw-bold text-light{% endif %}" href="{% url 'employes' %}">
            <i class="bi bi-people-fill"></i> Gestion employés
          </a>
        </li>
      </ul>
      

      <!-- Bouton Déconnexion -->
      <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#logoutModal">
        Se déconnecter
      </button>

      <span style="opacity: 0;">__</span>
      
      <button id="modeToggle" class="btn btn-outline-light d-flex align-items-center" aria-label="Changer mode clair/sombre">
        <i id="modeIcon" class="bi bi-sun-fill"></i>
        <span class="ms-2">Mode clair</span>
      </button>
    </div>
  </div>
</nav>

<!-- CONTENU PRINCIPAL -->
<div class="container">
  {% block content %}{% endblock %}
</div>
<!-- Footer -->
<footer class="bg-primary text-white text-center py-3 mt-5">
  © 2025 PharmaShop - Tous droits réservés
</footer>



<!-- Modal de confirmation de deconnexion -->
<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="logoutModalLabel">Confirmer la déconnexion</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
      </div>
      <div class="modal-body">
        Êtes-vous sûr de vouloir vous déconnecter {{utilisateur.username}} ?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
        <a href="{% url 'logout' %}" class="btn btn-danger">Se déconnecter</a>
      </div>
    </div>
  </div>
</div>

<script src="{% static 'js/scripts.js' %}"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const modeToggle = document.getElementById('modeToggle');
  const modeIcon = document.getElementById('modeIcon');
  const modeText = modeToggle.querySelector('span');

  // Fonction pour appliquer mode selon localStorage
  function applyMode(mode) {
    if (mode === 'dark') {
      document.body.classList.add('dark-mode');
      modeIcon.className = 'bi bi-moon-fill';
      modeText.textContent = 'Mode sombre';
      modeToggle.classList.remove('btn-outline-light');
      modeToggle.classList.add('btn-outline-warning');
    } else {
      document.body.classList.remove('dark-mode');
      modeIcon.className = 'bi bi-sun-fill';
      modeText.textContent = 'Mode clair';
      modeToggle.classList.remove('btn-outline-warning');
      modeToggle.classList.add('btn-outline-light');
    }
  }

  // Au chargement, on récupère la préférence
  const savedMode = localStorage.getItem('mode') || 'light';
  applyMode(savedMode);

  // Au clic sur toggle, on inverse et stocke
  modeToggle.addEventListener('click', () => {
    const currentMode = document.body.classList.contains('dark-mode') ? 'dark' : 'light';
    const newMode = currentMode === 'dark' ? 'light' : 'dark';
    applyMode(newMode);
    localStorage.setItem('mode', newMode);
  });
</script>
</body>
</html>
